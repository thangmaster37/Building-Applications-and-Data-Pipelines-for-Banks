<!DOCTYPE html>
<html lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <!-- Meta, title, CSS, favicons, etc. -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="icon" href="images/favicon.ico" type="image/ico" />

    <title>Moduck Bank | Loan Application</title>

    <!-- Bootstrap -->
    <link href="../vendors/bootstrap/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome -->
    <link href="../vendors/font-awesome/css/font-awesome.min.css" rel="stylesheet">
    <!-- NProgress -->
    <link href="../vendors/nprogress/nprogress.css" rel="stylesheet">
    <link href="./css/transaction/transaction.css" rel="stylesheet">



    <!-- Custom Theme Style -->
    <link href="../build/css/custom.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
  </head>

  <body class="nav-md">
    <div class="container body">
      <div class="main_container">
        <div class="col-md-3 left_col">
          <div class="left_col scroll-view">
            <div class="navbar nav_title" style="border: 0;">
              <a href="index.html" class="site_title"><i class="fa fa-paw"></i> <span>Moduck Bank</span></a>
            </div>

            <div class="clearfix"></div>

            <!-- menu profile quick info -->
            <div class="profile clearfix">
              <div class="profile_pic">
                <img src="images/img.jpg" alt="..." class="img-circle profile_img">
              </div>
              <div class="profile_info">
                <span>Welcome,</span>
                <h2>User Admin</h2>
              </div>
            </div>
            <!-- /menu profile quick info -->

            <br />

            <!-- sidebar menu -->
            <div id="sidebar-menu" class="main_menu_side hidden-print main_menu">
              <div class="menu_section">
                <h3>General</h3>
                <ul class="nav side-menu">
                  <li><a><i class="fa fa-home"></i> Home <span class="fa fa-chevron-down"></span></a>
                    <ul class="nav child_menu">
                      <li><a href="dashboard.html">Dashboard1</a></li>
                      <li><a href="../production/index.html">Dashboard2</a></li>
                      <!-- <li><a href="../production/index2.html">Dashboard3</a></li> -->
                      <!-- <li><a href="../production/index3.html">Dashboard4</a></li> -->
                    </ul>
                  </li>
                  <li><a><i class="fa fa-edit"></i> Forms <span class="fa fa-chevron-down"></span></a>
                    <ul class="nav child_menu">
                      <li><a href="loan_application.html">Credit Score</a></li>
                      <li><a href="saving_deposit.html">Saving Deposit</a></li>
                      <li><a href="transaction.html">Transaction</a></li>
                    </ul>
                  </li>
                  
                  <li><a><i class="fa fa-table"></i> Database <span class="fa fa-chevron-down"></span></a>
                    <ul class="nav child_menu">
                      <li><a href="../production/loan_info.html">Loan Information</a></li>
                      <li><a href="../production/savingdeposit_info.html">SavingDeposit Information</a></li>
                    </ul>
                  </li>
                  <!-- <li><a><i class="fa fa-bar-chart-o"></i> Data Analysis <span class="fa fa-chevron-down"></span></a>
                    <ul class="nav child_menu">
                      <li><a href="../production/echarts.html">ECharts</a></li>
                    </ul>
                  </li> -->
                </ul>
              </div>
              

            </div>
            <!-- /sidebar menu -->

            <!-- /menu footer buttons -->
            <div class="sidebar-footer hidden-small">
              <a data-toggle="tooltip" data-placement="top" title="Settings">
                <span class="glyphicon glyphicon-cog" aria-hidden="true"></span>
              </a>
              <a data-toggle="tooltip" data-placement="top" title="FullScreen">
                <span class="glyphicon glyphicon-fullscreen" aria-hidden="true"></span>
              </a>
              <a data-toggle="tooltip" data-placement="top" title="Lock">
                <span class="glyphicon glyphicon-eye-close" aria-hidden="true"></span>
              </a>
              <a data-toggle="tooltip" data-placement="top" title="Logout" href="login.html">
                <span class="glyphicon glyphicon-off" aria-hidden="true"></span>
              </a>
            </div>
            <!-- /menu footer buttons -->
          </div>
        </div>

        <!-- top navigation -->
        <div class="top_nav">
          <div class="nav_menu">
            <nav>
              <div class="nav toggle">
                <a id="menu_toggle"><i class="fa fa-bars"></i></a>
              </div>

              <ul class="nav navbar-nav navbar-right">
                <li class="">
                  <a href="javascript:;" class="user-profile dropdown-toggle" data-toggle="dropdown" aria-expanded="false">
                    <img src="images/img.jpg" alt="">User Admin
                    <span class=" fa fa-angle-down"></span>
                  </a>
                  <ul class="dropdown-menu dropdown-usermenu pull-right">
                    <li><a href="javascript:;"> Profile</a></li>
                    <li>
                      <a href="javascript:;">
                        <span class="badge bg-red pull-right">50%</span>
                        <span>Settings</span>
                      </a>
                    </li>
                    <li><a href="javascript:;">Help</a></li>
                    <li><a href="login.html"><i class="fa fa-sign-out pull-right"></i> Log Out</a></li>
                  </ul>
                </li>

                <li role="presentation" class="dropdown">
                  <a href="javascript:;" class="dropdown-toggle info-number" data-toggle="dropdown" aria-expanded="false">
                    <i class="fa fa-envelope-o"></i>
                    <span class="badge bg-green">6</span>
                  </a>
                  <ul id="menu1" class="dropdown-menu list-unstyled msg_list" role="menu">
                    <li>
                      <a>
                        <span class="image"><img src="images/img.jpg" alt="Profile Image" /></span>
                        <span>
                          <span>User Admin</span>
                          <span class="time">3 mins ago</span>
                        </span>
                        <span class="message">
                          Film festivals used to be do-or-die moments for movie makers. They were where...
                        </span>
                      </a>
                    </li>
                    <li>
                      <a>
                        <span class="image"><img src="images/img.jpg" alt="Profile Image" /></span>
                        <span>
                          <span>User Admin</span>
                          <span class="time">3 mins ago</span>
                        </span>
                        <span class="message">
                          Film festivals used to be do-or-die moments for movie makers. They were where...
                        </span>
                      </a>
                    </li>
                    <li>
                      <a>
                        <span class="image"><img src="images/img.jpg" alt="Profile Image" /></span>
                        <span>
                          <span>User Admin</span>
                          <span class="time">3 mins ago</span>
                        </span>
                        <span class="message">
                          Film festivals used to be do-or-die moments for movie makers. They were where...
                        </span>
                      </a>
                    </li>
                    <li>
                      <a>
                        <span class="image"><img src="images/img.jpg" alt="Profile Image" /></span>
                        <span>
                          <span>User Admin</span>
                          <span class="time">3 mins ago</span>
                        </span>
                        <span class="message">
                          Film festivals used to be do-or-die moments for movie makers. They were where...
                        </span>
                      </a>
                    </li>
                    <li>
                      <div class="text-center">
                        <a>
                          <strong>See All Alerts</strong>
                          <i class="fa fa-angle-right"></i>
                        </a>
                      </div>
                    </li>
                  </ul>
                </li>
              </ul>
            </nav>
          </div>
        </div>
        <!-- /top navigation -->

        <!-- page content -->
        <div class="right_col" role="main">
          <div class="container">
            <div class="transaction-history">
              <h2>Lịch sử giao dịch</h2>
              <ul class="transaction-list" id="transaction-list">
              </ul>
            </div>
            <div class="transfer-form">
              <h2>Giao diện chuyển tiền</h2>
              <form>
                <div class="form-info">
                  <p class="info1">TÀI KHOẢN THANH TOÁN</p>
                  <p class="info2" id="info2">0388423980</p>
                  <p class="info3" id="info3"></p>

                </div>
                <div class="remittance"><strong>Chuyển tiền</strong></div>
                <div class="form-group">
                  <!-- <input type="text" name="bankingName" placeholder="Ngân hàng" class="input"> -->
                  <select class="option" id="banktype">
                    <option value="">Ngân hàng</option>
                    <option value="MBBank">NHTMCP Quân đội (MB)</option>
                    <option value="VPBank">NHTMCP VN Thịnh Vượng (VP Bank)</option>
                    <option value="TechcomBank">NHTMCP Kỹ thương VN (Techcombank)</option>
                    <option value="VietcomBank">Ngân hàng Ngoại thương Việt Nam (Vietcombank)</option>
                    <option value="BIDV">Ngân hàng Đầu tư và Phát triển VN (BIDV)</option>
                    <option value="VietinBank">Ngân hàng Công thương VN (Vietinbank)</option>
                    <option value="AgriBank">Ngân hàng Nông nghiệp và Phát triển Nông thôn VN (Agribank)</option>
                    <option value="VIB">NHTMCP Quốc tế (VIB)</option>
                    <option value="ACB">NHTMCP Á châu (ACB)</option>
                    <option value="SHB">NHTMCP Sài gòn - Hà nội (SHB)</option>
                    <option value="SaigonBank">NHTMCP SG Công Thương (SaigonBank)</option>
                    <option value="SCB">NHTMCP Sài Gòn (SCB)</option>
                    <option value="OCB">NHTMCP Phương Đông (OCB)</option>
                    <option value="SeaBank">NHTMCP Đông Nam Á (Seabank)</option>
                    <option value="OceanBank">NHTMCP Đại Dương (Oceanbank)</option>
                    <option value="GPBank">NHTMCP Dầu khí Toàn cầu (GPBank)</option>
                    <option value="ABBank">NHTMCP An Bình (ABBank)</option>
                    <option value="PGBank">NHTMCP Xăng dầu Petrolimex (PGBank)</option>
                    <option value="HDBank">NHTMCP phát triển TPHCM (HDBank)</option>
                    <option value="EximBank">NHTMCP Xuất Nhập Khẩu (EximBank)</option>
                  </select>
                  <input type="text" name="accountNumber" placeholder="Số tài khoản" class="input" id="accountNumber">
                  <select id="type" required="required" class="option">
                    <option value="">Type</option>
                    <option value="1">Mua Sắm</option>
                    <option value="2">Mua Nhà</option>
                    <option value="3">Thanh Toán Hóa Đơn</option>
                    <option value="4">Thanh Toán Học Phí</option>
                    <option value="5">Thanh Toán Lương</option>
                    <option value="6">Mua Cổ Phiếu</option>
                    <option value="7">Từ Thiện</option>
                    <option value="8">Đóng Bảo Hiểm</option>
                    <option value="9">Du Lịch</option>
                    <option value="10">Trả Nợ</option>
                  </select>
                  <select id="method" required="required" class="option">
                    <option value="">Method</option>
                    <option value="Wire Transfer">Wire Transfer</option>
                    <option value="ATM Card">ATM Card</option>
                    <option value="Credit Card">Credit Card</option>
                    <option value="Debit Card">Debit Card</option>
                  </select>
                </div>
              
                <div class="money"><strong>Số tiền</strong></div>
                <div class="form-group">
                  <input type="number" name="amount" placeholder="Nhập số tiền" class="input" id="amount">
                  <input type="text" name="content" placeholder="Nội dung chuyển khoản" class="input" id="content">
                </div>
                <div class="form-group">
                  <button type="submit" class="submit" onclick="transaction(event)">Chuyển tiền</button>
                </div>
              </form>
            </div>
          </div>
        </div>
        <!-- /page content -->

        <!-- footer content -->
        <footer>
          <div class="pull-right">
            CreditSense - Redefining Credit
          </div>
          <div class="clearfix"></div>
        </footer>
        <!-- /footer content -->
      </div>
    </div>


    <!-- jQuery -->
    <script src="../vendors/jquery/dist/jquery.min.js"></script>
    <!-- Bootstrap -->
    <script src="../vendors/bootstrap/dist/js/bootstrap.min.js"></script>
    <!-- FastClick -->
    <script src="../vendors/fastclick/lib/fastclick.js"></script>
    <!-- NProgress -->
    <script src="../vendors/nprogress/nprogress.js"></script>
    <!-- jQuery Smart Wizard -->
    <script src="../vendors/jQuery-Smart-Wizard/js/jquery.smartWizard.js"></script>
    <!-- Switchery -->
    <link href="../vendors/switchery/dist/switchery.min.css" rel="stylesheet">
    <!-- Switchery -->
    <script src="../vendors/switchery/dist/switchery.min.js"></script>
    <!-- Custom Theme Scripts -->
    <script src="../build/js/custom.min.js"></script>
    <!-- jquery.inputmask -->
    <script src="../vendors/jquery.inputmask/dist/min/jquery.inputmask.bundle.min.js"></script>

    <!-- Chart.js -->
    <script src="../vendors/Chart.js/dist/Chart.min.js"></script>

    <!-- morris.js -->
    <script src="../vendors/raphael/raphael.min.js"></script>
    <script src="../vendors/morris.js/morris.min.js"></script>

    <script src="./js/transaction/transaction.js"></script>

    <script>
      function transaction(event) {
          event.preventDefault();
      
          // Lấy các giá trị được nhập
          var banktype = document.getElementById("banktype").value;
          var toBankAccount = document.getElementById("accountNumber").value;
          var typeID = parseInt(document.getElementById("type").value);
          var method = document.getElementById("method").value;
          var amount = parseFloat(document.getElementById("amount").value);
          var content = document.getElementById("content").value;

          // Get username login
          const username = localStorage.getItem('username');

          if (banktype !== "" && toBankAccount !== "" && typeID !== null && 
              method !== "" && amount !== null && content !== "" && username !== "") {
                axios.post('http://127.0.0.1:8000/api/transaction', {
                    username: username,
                    banktype: banktype,
                    toBankAccount: toBankAccount,
                    typeID: typeID,
                    method: method,
                    amount: amount,
                    content: content
                })
                .then(response => {
                  const data = response.data;
                  if (data.response == true) {
                    location.href = "transaction.html";
                  }
                  else {
                    alert("Account not exists: Check account and bank!");
                  }
                })
                .catch(error => {
                  console.log('Error:', error);
                });
            }
          else {
            alert("Missing Values");
          }
        }
    </script>

    <script>
      // Get username login
      const username = localStorage.getItem('username');

      axios.post('http://127.0.0.1:8000/api/account_surplus', {
          username: username
      })

      .then(response => {
        const data = response.data;
        console.log(data.account);
        const account = document.getElementById('info2');
        const surplus = document.getElementById('info3');
        account.innerHTML = `${data.account}`;
        surplus.innerHTML = `${data.surplus}`;
      })
      .catch(error => {
        console.log('Error:', error);
      });

    </script>

    <script>

      axios.post('http://127.0.0.1:8000/api/data_transaction', {
        username: username
      })

      .then(response => {
        const data = response.data.transaction;
        var string = ""
        for (var i = 0; i < data.length; i++) {
          var element = data[i];
          string += " <li class='transaction'>";
          string += " <div class='details'> ";
          if (element[3] === 1) {
            string += " <span class='amount' style='color: red;'> -" + element[0] + " VND </span> ";
          } else {
            string += " <span class='amount' style='color: springgreen;'> +" + element[0]  + " VND </span> ";
          }
          string += " <p class='date'> <strong>" + element[2] + " </strong> </p> ";
          string += " </div> ";
          string += " <div class='status'> ";
          string += " <span class='success'> <strong>" + element[1] + " </strong> </span> ";
          string += " </div> ";
          string += " </li> ";
        }

        const transaction_list = document.getElementById('transaction-list');
        transaction_list.innerHTML = string;
      })
      .catch(error => {
        console.log('Error:', error);
      });
    </script>


  </body>
</html>
<style>
.loader {
    border: 16px solid #f3f3f3; /* Light grey */
    border-top: 16px solid #3498db; /* Blue */
    border-radius: 50%;
    width: 120px;
    height: 120px;
    animation: spin 2s linear infinite;
    margin:auto;
}

@keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
}
</style>

